module.exports.name = require('./package.json').name;

module.exports.version = require('./package.json').version;

module.exports.register = function (plugin, options, next) {
  var Hapi = plugin.hapi;

  plugin.ext('onPreResponse', function (request, next) {
    var response = request.response();

    if(response.variety === "obj" && typeof response.raw.promise === 'object' && typeof response.raw.promise.then === 'function'){
      return response.raw.promise.then(function(res){
        return next(res);
      }, function(err){
        return next(err);
      });
    }

    next();
  });

  next();
};
